{% extends "base.html" %}

{% block content %}
<div class="card">
  <h2>All meter readings</h2>

  {% if readings %}
    <table>
      <thead>
      <tr>
        <th>#</th>
        <th>Date</th>
        <th>Meter (kWh)</th>
        <th style="width:140px;">Actions</th>
      </tr>
      </thead>
      <tbody>
      {% for r in readings %}
        <tr>
          <td>{{ loop.index }}</td>
          <td>
            <form method="post" style="display:flex;align-items:center;gap:0.25rem;">
              <input type="hidden" name="action" value="update">
              <input type="hidden" name="index" value="{{ loop.index0 }}">
              <input type="date"
                     name="date"
                     value="{{ r.date.isoformat() }}"
                     style="font-size:0.8rem;padding:0.1rem 0.25rem;">
          </td>
          <td>
              <input type="number"
                     name="meter_reading"
                     step="0.1"
                     value="{{ '%.1f'|format(r.meter_reading) }}"
                     style="width:100px;font-size:0.8rem;padding:0.1rem 0.25rem;">
          </td>
          <td>
              <button type="submit"
                      style="font-size:0.75rem;padding:0.15rem 0.4rem;margin-right:0.2rem;">
                Save
              </button>
            </form>
            <form method="post" style="display:inline;">
              <input type="hidden" name="action" value="delete">
              <input type="hidden" name="index" value="{{ loop.index0 }}">
              <button type="submit"
                      onclick="return confirm('Delete this reading?');"
                      style="font-size:0.75rem;padding:0.15rem 0.4rem;background:#fee2e2;border-color:#fecaca;">
                Delete
              </button>
            </form>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
    <p style="font-size:0.75rem;color:#6b7280;margin-top:0.5rem;">
      Changes are saved directly back to <code>readings.csv</code>.  
      Editing here will also affect all statistics and predictions.
    </p>
  {% else %}
    <p>No readings yet. Go to the Input page to add some.</p>
  {% endif %}
</div>
{% endblock %}
